<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>localStorage</title>
<style>
.cell {
  display: inline-block;
  margin: 0.27em;
  padding: 0.27em;
  outline: 1px solid;
  min-width: 13em;
  max-width: 13em;
}
.key {
  text-align: right;
}
</style>
<script type="text/javascript">
function addRecord(keys, vals, deli) {
  for(var i in keys) {
    var keyVals = localStorage.getItem(keys[i])
    keyVals += deli + vals[i]
    localStorage.setItem(keys[i], keyVals)
  }
}
function addRecords(keys, records, deli) {
  for(var i in records) {
    addRecord(keys, records[i], deli)
  }
}
function getTable(keys) {
  var table = []
  for(var i in keys) {
    table.push(localStorage.getItem(keys[i]))
  }
  return table
}
function iniTable(keys) {
  localStorage.clear()
  for(var i in keys) {
    localStorage.setItem(keys[i], keys[i])
  }
}
function showTable(keys, deli) {
  var html = ''
  var table = getTable(keys)
  for(var i in table) {
    var cells = table[i].split(deli)
    html += '<div class="row">'
    for(var j in cells) {
      var cell = cells[j]
      html += '<div class="cell'
      if(j == 0) {
        html += ' key'
      }
      html += '">' // .cell
      html += cell
      html += '</div>'
    }
    html += '</div>' // .row
  }
  document.getElementsByTagName('body')[0].innerHTML = html
}
function csvToArrays(csv, rowDeli, cellDeli) {
  var records = []
  var rows = csv.split(rowDeli)
  for (var i in rows) {
    records.push(rows[i].split(cellDeli))
  }
  return records
}
document.addEventListener("DOMContentLoaded", function(event) { 
var rowDeli = '\n'
var cellDeli = ','
var csv = 'firstname, lastname, passion\n\
Ida,Ebkes,Pythons\n\
Ada,Ebkes,Lions'
var records = csvToArrays(csv, rowDeli, cellDeli)
var keys = records.shift()
iniTable(keys)
addRecords(keys, records, cellDeli)
showTable(keys, cellDeli)
}); // doc.ready
</script>
</head>
<body lang="en" dir="ltr">
</body>
</html>
